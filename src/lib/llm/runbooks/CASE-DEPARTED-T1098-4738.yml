case_id: CASE-DEPARTED-T1098-4738
threat_type: DEPARTED
threat_type_kr: 퇴직자 위협
technique_id: T1098
technique_name_kr: 계정 조작
event_ids: [4738]
log_fields: |
  Target Account
  Changed Attributes
  Subject> Account Name
log_reason: |
  Target Account을 봤을 때 관리자/서비스 계정의 Changed Attributes에 "Password not required", "Account never expires"가 확인되면 계정 조작을 확인할 수 있다.
  Changed Attributes에서 "User must change password at next logon" 해제 또는 "Smart card is required" 비활성화가 확인되면 의심 악성 계정 설정 변경을 확인할 수 있어서 권한 상승 행위를 의심할 수 있다.
  Subject > Account Name을 봤을 때 비관리자 계정으로 Domain Admin/서비스 계정 변경이 확인되면 비인가 계정 조작을 확인할 수 있다.
log_scenario: |
  net user username /passwordreq:yes, PowerShell Set-ADUser, 또는 Active Directory 사용자 관리 도구로 계정 속성이 변경될 때 생성된다.
  정상 HR/관리 작업에서도 발생하나, 비정상 시간대/비관리자 계정 패턴으로 계정 조작 탐지 시 확인해야 하는 핵심 이벤트 로그이다.
summary: |
  공격자는 피해자 시스템에 대한 접근 권한을 유지 및/또는 상승시키기 위해 계정을 조작할 수 있다.
  계정 조작은 자격 증명이나 권한 그룹 수정과 같이 침해된 계정에 대한 공격자의 접근 권한을 유지하거나 변경하는 모든 행위를 포함할 수 있다.
  이러한 행위에는 비밀번호 기간 정책을 우회하고 침해된 자격 증명의 유효 기간을 유지하기 위해 반복적인 비밀번호 업데이트를 수행하는 것과 같이 보안 정책을 위반하도록 설계된 계정 활동도 포함될 수 있다.
policy_direction: |
  계정 조작 위협을 막기 위해서는 관리자·서비스 계정과 같은 고권한 계정의 속성 변경을 일반 사용자가 수행할 수 없도록 권한을 강하게 제한해야 한다.
  공격자는 비밀번호 만료를 막기 위해 “Account never expires”를 설정하거나 보안 속성을 약화(Password not required, Smart card requirement 제거 등)시켜 장기 지속성을 확보하므로, 계정 보안 속성의 변경 자체를 엄격히 통제해야 한다.
  또한 계정의 패스워드 정책·만료 정책·로그온 제약 조건을 표준화하여 비인가 계정이 속성을 변경해도 시스템 운영에 영향을 주지 못하도록 최소 권한 체계를 유지해야 한다.
  핵심은 고권한 계정 보호·계정 속성 변경 제한·비인가 계정의 계정 관리 차단이다.
steps:
  - title: Active Directory 관련 설정
    details: |
      Active Directory 환경에서는 dsa.msc(AD 사용자 및 컴퓨터)에서 관리자·서비스 계정의 속성(Security → Advanced Permissions)을 점검해 일반 사용자나 하위 계정이 "Reset password", "Write properties", "Change password" 권한을 갖지 않도록 설정한다
      
      gpedit.msc의 계정 정책 → 암호 정책/계정 잠금 정책을 통해 비밀번호 만료·길이·복잡성 요구사항을 강제해 공격자가 "Password not required"나 "Account never expires" 속성을 악용하는 것을 방지한다
      
      또한 lusrmgr.msc(로컬 계정 환경)에서는 관리자 그룹 멤버십을 정리해 불필요한 계정이 로컬 관리자 또는 운영 계정 속성을 변경하지 못하도록 한다
  - title: AppLocker 관련 설정
    details: |
      마지막으로 PowerShell(Set-ADUser, net user 등)을 통한 계정 속성 변경은 전담 관리자만 수행하도록 실행 권한(AppLocker/WDAC)과 운영 절차를 제한해 계정 조작 경로를 차단한다
operations_guidance: |
  ## 모니터링 팁
  - Event ID 4738에서 Target Account 필드를 주의 깊게 확인하세요.
  - 비정상적인 패턴이나 짧은 시간 내 반복적인 접근을 모니터링하세요.
  - 계정 조작 기법과 관련된 활동을 주의 깊게 관찰하세요.

  ## 오탐 가능성
  - 정상적인 시스템 관리 작업에서도 해당 이벤트가 발생할 수 있습니다.
  - 예약된 작업이나 백업 프로세스에 의한 정상 활동을 구분해야 합니다.

  ## 대응 방법
  - 관리자 작업은 사전 승인 프로세스를 적용하세요.
  - 예약된 작업은 화이트리스트로 등록하세요.
references:
  - title: MITRE ATT&CK - T1098
    url: https://attack.mitre.org/techniques/T1098/
  - title: Microsoft Event ID 4738
    url: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4738
