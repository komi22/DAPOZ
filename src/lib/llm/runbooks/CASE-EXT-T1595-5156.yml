case_id: CASE-EXT-T1595-5156
threat_type: EXT
threat_type_kr: 의도적 외부 공격자
technique_id: T1595
technique_name_kr: 능동적 스캐닝
event_ids: [5156]
log_fields: |
  Source Address
  Destination Address
  Destination Port
  Protocol
log_reason: |
  공격자가 여러 포트로 연속적인 네트워크 연결을 시도할 때 반복적으로 생성되는 가장 직접적인 스캐닝 탐지 이벤트이다.
  방화벽이 허용한 연결의 포트·프로토콜·원격지 정보를 상세히 기록하므로 다수 포트에 대한 접근 시도를 명확히 확인할 수 있다.
  동일 Source Address에서 짧은 시간 안에 다양한 포트로 연결이 발생하면 능동적 스캐닝 징후로 판단할 수 있다.
log_scenario: |
  공격자가 Nmap, Masscan 등 스캐닝 도구를 사용하여 다수의 포트에 빠르게 연결을 시도할 때 연속적으로 기록된다.
  SMB·RDP·HTTP 등 다양한 포트로 짧은 시간 안에 접근이 발생하면 외부 또는 내부에서 능동적 스캔이 수행된 것으로 판단할 수 있으며, 동일 Source Address에서 대량의 포트 접근이 감지될 경우 초기 정찰·취약점 탐색 행위로 볼 수 있다.
summary: |
  공격자는 표적 공격을 준비하기 위해 능동적 스캐닝을 수행하며, 이는 네트워크 트래픽을 이용해 피해자의 인프라를 직접 탐색하는 정찰 기법이다.
  스캐닝은 ICMP 등 기본 네트워크 프로토콜을 포함해 다양한 방식으로 실행될 수 있으며, 이를 통해 수집한 정보는 다른 정찰 활동(도메인·웹 정보 수집 등), 공격 준비(도구·인프라 구축), 초기 침투(원격 서비스 악용 등)에 활용된다.
policy_direction: |
  능동적 스캐닝을 차단하기 위해서는 내부 네트워크에서 불필요한 포트 노출을 최소화하고, 시스템 간 연결이 가능한 서비스 범위를 제한함으로써 공격자가 여러 포트에 접근할 수 있는 표면 자체를 줄여야 한다.
  또한 동일 출발지에서 다수 포트로 단시간 연결이 발생하는 패턴이 스캐닝 본질이므로, 네트워크 계층에서 비정상적인 다중 포트 접근을 차단하는 정책이 필요하다.
  더불어 중요 자산은 세그멘테이션과 ACL을 통해 외부·내부의 무분별한 포트 접근을 원천적으로 막아야 한다.
  핵심은 포트·서비스 노출 축소, 네트워크 경계 통제, 이상 트래픽 기반 차단 구조를 갖추는 것이다.
steps:
  - title: RDP 관련 설정
    details: |
      wf.msc(고급 방화벽)에서 인바운드 규칙을 정리해 RDP·SMB·HTTP 등 필요한 서비스만 개별적으로 허용하고, 나머지 포트는 기본 차단 상태로 유지해 다중 포트 스캐닝 효과를 크게 줄인다
      
      또한 동일 방화벽 메뉴에서 IP별 접근 제어를 설정해 특정 관리용 IP나 내부 구간만이 서버 주요 포트에 접근하도록 제한할 수 있다
      
      서비스별 포트가 불필요하게 열려 있는 경우 services.msc 또는 기능 관리에서 사용하지 않는 서비스(예: Telnet, FTP 서버 등)를 비활성화하여 포트 노출 자체를 제거한다
  - title: 상세 설정
    details: |
      마지막으로 네트워크 어댑터의 고급 설정에서 ICMP 에코 응답(핑 응답)을 비활성화해 기본적인 포트·호스트 식별 스캐닝을 어렵게 만들 수 있다
operations_guidance: |
  ## 모니터링 팁
  - Event ID 5156에서 Source Address 필드를 주의 깊게 확인하세요.
  - 비정상적인 패턴이나 짧은 시간 내 반복적인 접근을 모니터링하세요.
  - 능동적 스캐닝 기법과 관련된 활동을 주의 깊게 관찰하세요.

  ## 오탐 가능성
  - 정상적인 시스템 관리 작업에서도 해당 이벤트가 발생할 수 있습니다.
  - 예약된 작업이나 백업 프로세스에 의한 정상 활동을 구분해야 합니다.

  ## 대응 방법
  - 관리자 작업은 사전 승인 프로세스를 적용하세요.
  - 예약된 작업은 화이트리스트로 등록하세요.
references:
  - title: MITRE ATT&CK - T1595
    url: https://attack.mitre.org/techniques/T1595/
  - title: Microsoft Event ID 5156
    url: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-5156
