case_id: CASE-EXT-T1486-4688
threat_type: EXT
threat_type_kr: 의도적 외부 공격자
technique_id: T1486
technique_name_kr: 영향을 주기 위한 데이터 암호화/랜섬
event_ids: [4688]
log_fields: |
  New Process Name
  Process Command Line
log_reason: |
  Process Name과 Command Line을 봤을 때 .tzip C:\encrypted.docx 또는 encryptor.exe /silent가 확인되면 의심 랜섬웨어 실행을 확인할 수 있어서 데이터 암호화 가능성을 의심할 수 있다.
  Command Line에 .encrypted, ransom 문자열 또는 압축 옵션(mhe=on, ep1)이 확인되면 의심 대량 암호화 시작을 확인할 수 있어서 데이터 파괴 행위를 의심할 수 있다.
  4688 후 4663 급증 패턴 확인 시 랜섬웨어 암호화 체인을 확인할 수 있다.
log_scenario: |
  새로운 프로세스가 생성될 때마다 생성되며, certutil.exe, bitsadmin.exe, makecab.exe 등 LOLBin 악용이나 랜섬웨어 실행 시 핵심 증거로 기록된다.
  정상적인 소프트웨어 실행에서도 발생하나, 의심스러운 CommandLine 패턴 분석 시 확인해야 하는 핵심 이벤트 로그이다.
  이때 "encryptor.exe /silent" 같은 예시는 이해를 돕기 위한 것이고, 실제 공격은 랜섬웨어 마다 다양하다는 사실을 인지해야 한다.
  좀 더 상세한 판단을 위해서는 4663(Object Access – 파일 접근/변경) 로그를 함께 확인하는 것을 권장한다.
summary: |
  공격자는 대상 시스템이나 네트워크 내 다수의 시스템의 데이터를 암호화하여 시스템 및 네트워크 리소스 가용성을 차단할 수 있다.
  로컬 및 원격 드라이브의 파일이나 데이터를 암호화하고 복호화 키 접근을 차단하여 저장된 데이터에 접근할 수 없도록 만들 수 있다.
  이는 피해자에게 복호화 또는 복호화 키(랜섬웨어)를 제공하는 대가로 금전적 보상을 요구하거나, 키가 저장 또는 전송되지 않은 경우 데이터에 영구적으로 접근할 수 없도록 만들기 위한 목적으로 수행될 수 있다.
policy_direction: |
  랜섬웨어 기반 암호화를 방지하기 위해서는 파일 시스템에 대한 대량 읽기·쓰기 작업과 특정 확장자 생성 패턴을 유발하는 악성 프로세스의 실행 자체를 차단하는 것이 핵심이다.
  공격자는 정상 프로그램 또는 LOLBins(certutil, makecab, bitsadmin 등)을 통해 암호화 프로세스를 실행하므로, 명령 실행 경로와 실행 주체를 엄격히 통제해야 한다.
  또한 중요 데이터는 최소 권한 기반으로 접근을 제한하고, 암호화 도구·스크립트·패커가 실행될 수 있는 환경을 최소화해야 암호화 확산을 막을 수 있다.
  즉, 실행 통제·권한 최소화·악성 명령 실행 차단이 랜섬웨어 방어의 기반이 된다.
steps:
  - title: AppLocker 관련 설정
    details: |
      AppLocker 또는 WDAC 정책을 적용해 certutil.exe, makecab.exe, bitsadmin.exe, wscript.exe, powershell.exe, rundll32.exe 등 주로 랜섬웨어에서 악용되는 LOLBins 실행을 기본적으로 차단하거나 특정 관리자 계정만 실행하도록 제한한다
      
      중요한 폴더(예: 문서, 바탕화면, 네트워크 공유 경로 등)는 NTFS 권한을 조정해 일반 사용자 권한으로는 대량 쓰기·삭제·재명명 작업이 불가능하도록 최소 권한 구조를 유지한다
      
      Office 문서 기반 감염을 방지하기 위해 Word·Excel 매크로를 “서명된 매크로만 허용”으로 설정하고, OLE/DDE 자동 실행을 비활성화해 암호화 스크립트 실행 경로를 사전 차단한다
  - title: 상세 설정
    details: |
      마지막으로 불필요한 네트워크 공유를 제거하거나, 공유 폴더의 쓰기 권한을 반드시 필요한 사용자만 갖도록 제한하여 원격 경로로 암호화가 확산되는 것을 방지한다
operations_guidance: |
  ## 모니터링 팁
  - Event ID 4688에서 New Process Name 필드를 주의 깊게 확인하세요.
  - 비정상적인 패턴이나 짧은 시간 내 반복적인 접근을 모니터링하세요.
  - 영향을 주기 위한 데이터 암호화/랜섬 기법과 관련된 활동을 주의 깊게 관찰하세요.

  ## 오탐 가능성
  - 정상적인 시스템 관리 작업에서도 해당 이벤트가 발생할 수 있습니다.
  - 예약된 작업이나 백업 프로세스에 의한 정상 활동을 구분해야 합니다.

  ## 대응 방법
  - 관리자 작업은 사전 승인 프로세스를 적용하세요.
  - 예약된 작업은 화이트리스트로 등록하세요.
references:
  - title: MITRE ATT&CK - T1486
    url: https://attack.mitre.org/techniques/T1486/
  - title: Microsoft Event ID 4688
    url: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4688
