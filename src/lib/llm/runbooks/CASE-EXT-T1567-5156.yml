case_id: CASE-EXT-T1567-5156
threat_type: EXT
threat_type_kr: 의도적 외부 공격자
technique_id: T1567
technique_name_kr: (웹 서비스를 통한 유출)
event_ids: [5156]
log_fields: |
  Source Address
  Destination Address
  Destination Port
  Protocol
  Process Name
  Bytes Sent
log_reason: |
  프로세스가 외부 웹 서비스로 지속적 또는 대량 송신(Outbound) 트래픽을 허용받을 때 기록된다.
  정상 프로그램(브라우저·업무용 클라이언트 등)이 짧은 시간 내 특정 웹스토리지 도메인으로 반복적·대용량 트래픽을 발생시키면 웹 업로드 기반의 데이터 유출 가능성을 의심할 수 있다.
  평소 접속하지 않던 웹 저장소로의 연결, 비정상 포트·프로세스 조합, 업로드 패턴(주기적 전송·파일 분할 업로드)이 보이면 더욱 명확한 근거가 된다.
log_scenario: |
  공격자가 내부 시스템에서 탈취한 계정 정보·키로깅 결과·스크린샷·내부 문서 등을 C2 서버로 업로드하는 과정에서 발생한다.
  파일 분할 전송, 압축 후 업로드, 일정 주기마다 반복 전송 등으로 대량의 데이터가 외부 C2 인프라로 흘러갈 때 이 로그가 꾸준히 기록된다.
  또한 정찰 후 권한 상승을 마친 악성 프로세스가은밀하게 수집 데이터를 외부로 내보낼 때도 동일한 이벤트가 발생한다.
summary: |
  공격자는 합법적인 외부 웹 서비스를 이용해 데이터를 유출하며, 이런 서비스는 평소에도 사용되기 때문에 탐지가 어렵다.
  트래픽이 이미 허용되어 있고 SSL/TLS 암호화까지 적용되어 있어, 유출 행위가 정상 통신처럼 보이는 효과가 있다.
policy_direction: |
  웹 기반 데이터 유출은 정상적인 HTTPS 트래픽 속에 데이터를 숨겨 전송하는 방식이므로, 핵심은 “어떤 프로세스가 어떤 웹 서비스로 데이터를 보낼 수 있는지”를 제한하는 것이다.
  특히 평소 사용하지 않는 웹 저장소·파일 호스팅 서비스로의 업로드 트래픽을 차단하고, 대량 송신(Bytes Sent 증가)이나 반복 업로드 패턴을 최소화하는 구조를 만들어야 한다.
  또한 비업무 애플리케이션이 외부 웹 서비스에 접근하지 못하도록 통제하면 정상적 HTTPS 트래픽을 가장하는 유출 채널을 근본적으로 줄일 수 있다.
  즉, 외부 웹 서비스 접근 통제·업로드 경로 제한·비정상 프로세스의 아웃바운드 차단이 핵심 전략이다.
steps:
  - title: 상세 설정
    details: |
      wf.msc(고급 방화벽)에서 아웃바운드 규칙을 구성해 브라우저·업무용 앱만 외부 HTTPS(443) 통신을 허용하고, PowerShell·cmd·wscript 등 비정상 실행 프로세스는 웹 서비스로 나가는 모든 아웃바운드를 차단한다
      
      기업 환경에서는 특정 웹 저장소(예: Dropbox, Google Drive, OneDrive 등)로의 트래픽을 방화벽 차원에서 차단하거나, 오직 승인된 서비스만 접근 가능하도록 도메인 기반 허용 리스트 정책을 구성할 수 있다
      
      또한 FTP/SFTP/웹 업로드 기능을 제공하는 클라이언트 프로그램을 제거하거나 비활성화해 업로드 경로 자체를 줄인다
  - title: 상세 설정
    details: |
      마지막으로 내부 DNS 설정을 고정해 악성 프로세스가 자체적으로 외부 웹 서비스를 호출하거나 새로운 도메인을 탐색하는 경로를 제한할 수 있다
operations_guidance: |
  ## 모니터링 팁
  - Event ID 5156에서 Source Address 필드를 주의 깊게 확인하세요.
  - 비정상적인 패턴이나 짧은 시간 내 반복적인 접근을 모니터링하세요.
  - (웹 서비스를 통한 유출) 기법과 관련된 활동을 주의 깊게 관찰하세요.

  ## 오탐 가능성
  - 정상적인 시스템 관리 작업에서도 해당 이벤트가 발생할 수 있습니다.
  - 예약된 작업이나 백업 프로세스에 의한 정상 활동을 구분해야 합니다.

  ## 대응 방법
  - 관리자 작업은 사전 승인 프로세스를 적용하세요.
  - 예약된 작업은 화이트리스트로 등록하세요.
references:
  - title: MITRE ATT&CK - T1567
    url: https://attack.mitre.org/techniques/T1567/
  - title: Microsoft Event ID 5156
    url: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-5156
