case_id: CASE-USER-T1204-4688
threat_type: USER
threat_type_kr: 사용자 부주의
technique_id: T1204
technique_name_kr: 사용자 실행
event_ids: [4688]
log_fields: |
  Account Name
  Logon ID
  Creator Process Name
  New Process Name
  Process Command Line
  Mandatory Level
log_reason: |
  사용자가 직접 악성 파일·링크를 실행할 때 생성되는 신규 프로세스 생성 로그로, 사용자 실행 기반 초기 침해 여부를 판단하는 핵심 근거가 된다.
  정상적인 경우 Outlook/Chrome/Explorer/Word/Excel 등에서 하위 프로세스가 생성되지만, 비정상적인 경우 powershell.exe, wscript.exe, mshta.exe, rundll32.exe 등 스크립트 실행 엔진이 연달아 생성되는 패턴이 나타난다.
  또한 Process CommandLine 값에 URL 호출(-w hidden) 또는 외부 파일 실행 흔적이 포함되면 사용자 실행을 통한 악성코드 로딩·다운로드 가능성을 명확히 판단할 수 있다.
log_scenario: |
  사용자가 피싱·스피어피싱 메시지에서 문서, 실행파일, ZIP 파일 등을 열람하면서 매크로·스크립트가 자동 실행되거나 보안 경고를 우회하여 악성코드가 구동될 때 동일한 4688 신규 프로세스 로그가 기록된다.
  Outlook.exe 또는 Chrome/Winword.exe 등 사용자 애플리케이션을 부모로 하여 powershell.exe, wscript.exe, mshta.exe, rundll32.exe 등이 비정상적으로 생성되는 경우 사용자 실행 기반 초기 감염 가능성이 높다.
  또한 ZIP 내부 실행파일(.exe) disguised icon, 바로가기(.lnk) 파일을 통해 사용자가 직접 클릭해 실행하도록 유도된 경우에도 동일한 패턴의 4688 이벤트가 발생한다.
summary: |
  공격자가 사회공학 기법을 이용해 사용자가 직접 악성 파일·링크를 열거나 코드를 실행하도록 유도하는 공격 방식이다.
  보통 피싱·스피어피싱의 후속 행동으로 발생하며, 문서·스크립트 실행, 악성 웹사이트 접속, 원격 액세스 도구 설치 등 다양한 형태로 나타난다.
  공격자는 기술지원 사기나 가짜 콜센터 등도 활용하여 사용자가 스스로 악성코드를 다운로드·실행하게 만들어 초기 침해 또는 추가 공격 경로를 확보한다.
policy_direction: |
  사용자 실행 기반 공격을 막기 위해서는 사용자가 실행하는 파일·링크·스크립트가 임의로 시스템 명령(powershell, cmd, wscript 등)을 호출하지 못하도록 실행 흐름을 통제해야 한다.
  문서·브라우저·메일 기반 사회공학 공격을 통해 악성 파일이 실행되므로, 외부에서 내려받은 파일의 실행을 제한하고 자동 실행 기능(OLE, 매크로, Active Content)을 최소화하는 것이 중요하다.
  또한 사용자가 관리자 권한을 갖지 않도록 운영하여 악성 파일 실행 시에도 시스템 전체에 영향을 주지 못하게 해야 한다.
  핵심은 사용자 실행 환경의 자동 실행 차단, 스크립트 실행 제한, 권한 최소화이다.
steps:
  - title: AppLocker 관련 설정
    details: |
      AppLocker/WDAC 정책을 통해 다운로드 폴더·Temp·AppData 등에서 실행 파일(.exe, .js)이 실행되지 못하도록 차단해 사용자가 다운로드한 악성 파일을 직접 실행하는 경로를 줄인다
      
      Office에서는 매크로를 “서명된 매크로만 허용”으로 변경하고 OLE/DDE 자동 실행 기능을 비활성화해 문서 기반 악성 실행을 원천 차단한다
      
      브라우저·메일 클라이언트에서는 SmartScreen/첨부파일 보호 기능을 활성화하여 외부 파일을 자동 실행하거나 경고 없이 열지 못하도록 한다
  - title: 상세 설정
    details: |
      마지막으로 사용자 계정을 표준 사용자 권한으로 제한해, 사용자가 악성 파일을 실행하더라도 시스템 서비스·레지스트리·보안 설정에 영향을 주지 못하도록 방어한다
operations_guidance: |
  ## 모니터링 팁
  - Event ID 4688에서 Account Name 필드를 주의 깊게 확인하세요.
  - 비정상적인 패턴이나 짧은 시간 내 반복적인 접근을 모니터링하세요.
  - 사용자 실행 기법과 관련된 활동을 주의 깊게 관찰하세요.

  ## 오탐 가능성
  - 정상적인 시스템 관리 작업에서도 해당 이벤트가 발생할 수 있습니다.
  - 예약된 작업이나 백업 프로세스에 의한 정상 활동을 구분해야 합니다.

  ## 대응 방법
  - 관리자 작업은 사전 승인 프로세스를 적용하세요.
  - 예약된 작업은 화이트리스트로 등록하세요.
references:
  - title: MITRE ATT&CK - T1204
    url: https://attack.mitre.org/techniques/T1204/
  - title: Microsoft Event ID 4688
    url: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4688
